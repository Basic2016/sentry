{% extends "sentry/projects/manage.html" %}

{% load i18n %}
{% load sentry_helpers %}
{% load sentry_plugins %}

{% block title %}{% trans "Manage Integrations" %} | {{ block.super }}{% endblock %}

{% block main %}
    {% if page == 'issue-tracking' %}
      <h2>{% trans "Issue Tracking Integrations" %}</h2>
      <p>
        Enabling Issue Tracking will let you quickly create tasks within your existing tools.
        You'll find the new action on an issue's details page. Once you create an issue, you'll
        find a helpful annotation and link to the task in your project management tool.
      </p>
    {% elif page == 'notification' %}
      <h2>{% trans "Notification Integrations" %}</h2>
      <p>
        After adding a notification method to a project, you can add custom alert rules for
        the integration from your project's
        <a href="/{{ organization.slug }}/{{ project.slug }}/settings/alerts/rules/">
        alert settings page</a>.
      </p>
    {% else %}
      <h2>{% trans "Integrations" %}</h2>
    {% endif %}

    {% if plugins_with_status %}
      <form method="POST">
          {% csrf_token %}
          <div class="panel panel-default">
            <table class="table integrations simple">
                <thead>
                    <th colspan="2">Integration</th>
                    <th class="align-right">Enabled</th>
                </thead>
                <tbody>
                    {% for plugin, is_enabled in plugins_with_status %}
                        <tr class="{{ plugin.get_title|slugify }}">
                            <td colspan="2">
                                <div class="integration-icon"></div>
                                <h5>{{ plugin.get_title }} {% if plugin.version %}<span>v{{ plugin.version }}</span>{% else %}<span><em>{% trans "n/a" %}</em></span>{% endif %}</h5>
                                <p>
                                {% if plugin.author %}
                                    {% if plugin.author_url %}<a href="{{ plugin.author_url }}">{{ plugin.author }}</a>{% else %}{{ plugin.author }}{% endif %}
                                {% endif %}
                                {% if plugin.has_project_conf %} &middot; <a href="{% url 'sentry-configure-project-plugin' project.organization.slug project.slug plugin.slug %}">Configure plugin</a>{% endif %}
                                </p>
                            </td>
                            <td class="align-right">
                                <input type="checkbox" name="plugin" value="{{ plugin.slug }}"{% if is_enabled %} checked="checked"{% endif %}/>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
          </div>
          <div class="form-actions" style="border: 0">
              <input type="submit" class="btn btn-primary pull-right" value="Save Changes">
          </div>
      </form>
    {% else %}
      <div class="alert alert-info alert-block">
        <p>
          {% trans "There are no integrations available. Ask your Sentry team about integrating with your favorite tools." %}
        </p>
      </div>
    {% endif %}
{% endblock %}
